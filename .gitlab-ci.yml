stages:
  - build
  - test
  - deploy

build:
  stage: build
  image: maven:latest
  script:
    - cd BackEnd
    - echo "Building the pipeline"
    - mvn clean package
  artifacts:
    paths:
      - target
  tags:
    - dalfcs_gitlab_docker_ci

deploy_dev:
  image: docker:stable
  stage: deploy
  tags:
    - dalfcs_gitlab_docker_ci
  artifacts:
    paths:
      - target
  script:
    - cd BackEnd
    - apk update && apk add openssh
    - echo "dbURL=$DATABASE_TEST_URL" > config.properties
    - echo "dbUserName=$DATABASE_TEST_USERNAME" >> config.properties
    - echo "dbPassword=$DATABASE_TEST_PASSWORD" >> config.properties
    - echo "dbDriver=$DATABASE_DRIVER" >> config.properties
    - echo "Deploying the development pipeline"
    - cat config.properties
